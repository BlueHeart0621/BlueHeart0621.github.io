

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/image/self/portrait.jpg">
  <link rel="icon" href="/image/self/portrait.jpg">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="ä¸€ä¸ªè®°å½•å„ç§ç¬”è®°çš„å°åŒ£å­^-^">
  <meta name="author" content="BlueHeart0621">
  <meta name="keywords" content="é ‘å¼µã‚Œ">
  
    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script> <script src="/live2d-widget/autoload.js" type="text/javascript"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
  
  <title>PATã€Œ1003 Universal Travel Sites (35åˆ†)ã€ - ãŠå‰ã¯ã©ã“ã¾ã§è¦‹ãˆã¦ã„ã‚‹</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"blueheart0621.github.io","root":"/","version":"1.8.9","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"Â§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/image/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"c194cf0c8cbc33bfb846ba1329537d81","google":"G-SXJN0942X9","gtag":"G-D3DEHLLP3W","tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"A24MlA4oV7hlze3uNQiXDAIi-MdYXbMMI","app_key":"3moFK5Ao3TD4rjA1HCmPTSm6","server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="ãŠå‰ã¯ã©ã“ã¾ã§è¦‹ãˆã¦ã„ã‚‹" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>ãŠå‰ã¯ã©ã“ã¾ã§è¦‹ãˆã¦ã„ã‚‹</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                å‹é“¾
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/image/covers/%E5%9B%9B%E6%9C%88%E6%98%AF%E4%BD%A0%E7%9A%84%E8%B0%8E%E8%A8%80-1.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="PATã€Œ1003 Universal Travel Sites (35åˆ†)ã€">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-08-14 20:18" pubdate>
        2020å¹´8æœˆ14æ—¥ æ™šä¸Š
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.3k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      57
       åˆ†é’Ÿ
    </span>
  

  
  
    
      <!-- LeanCloud ç»Ÿè®¡æ–‡ç« PV -->
      <span id="leancloud-page-views-container" class="post-meta" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="leancloud-page-views"></span> æ¬¡
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">PATã€Œ1003 Universal Travel Sites (35åˆ†)ã€</h1>
            
            <div class="markdown-body">
              <h2 id="1-é¢˜ç›®">1. é¢˜ç›®</h2>
<p>é¢˜ç›®é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://pintia.cn/problem-sets/994805148990160896/problems/994805155688464384">PATã€Œ1003 Universal Travel Sites (35åˆ†)ã€</a> ã€‚</p>
<h3 id="Description">Description</h3>
<p>After finishing her tour around the Earth, CYLL is now planning a universal travel sites development project. After a careful investigation, she has a list of capacities of all the satellite transportation stations in hand. To estimate a budget, she must know the minimum capacity that a planet station must have to guarantee that every space vessel can dock and download its passengers on arrival.</p>
<h3 id="Input-Specification">Input Specification:</h3>
<p>Each input file contains one test case. For each case, the first line contains the names of the source and the destination planets, and a positive integer N (â‰¤500). Then N lines follow, each in the format: source[i] destination[i] capacity[i] where source[i] and destination[i] are the names of the satellites and the two involved planets, and capacity[i] &gt; 0 is the maximum number of passengers that can be transported at one pass from source[i] to destination[i]. Each name is a string of 3 uppercase characters chosen from {A-Z}, e.g., ZJU.</p>
<p>Note that the satellite transportation stations have no accommodation facilities for the passengers. Therefore none of the passengers can stay. Such a station will not allow arrivals of space vessels that contain more than its own capacity. It is guaranteed that the list contains neither the routes to the source planet nor that from the destination planet.</p>
<h3 id="Output-Specification">Output Specification:</h3>
<p>For each test case, just print in one line the minimum capacity that a planet station must have to guarantee that every space vessel can dock and download its passengers on arrival.</p>
<h3 id="Sample-Input">Sample Input:</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++">EAR MAR <span class="hljs-number">11</span><br>EAR AAA <span class="hljs-number">300</span><br>EAR BBB <span class="hljs-number">400</span><br>AAA BBB <span class="hljs-number">100</span><br>AAA CCC <span class="hljs-number">400</span><br>AAA MAR <span class="hljs-number">300</span><br>BBB DDD <span class="hljs-number">400</span><br>AAA DDD <span class="hljs-number">400</span><br>DDD AAA <span class="hljs-number">100</span><br>CCC MAR <span class="hljs-number">400</span><br>DDD CCC <span class="hljs-number">200</span><br>DDD MAR <span class="hljs-number">300</span><br></code></pre></td></tr></table></figure>
<h3 id="Sample-Output">Sample Output:</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-number">700</span><br></code></pre></td></tr></table></figure>
<h2 id="2-é¢˜è§£">2. é¢˜è§£</h2>
<h3 id="åˆ†æ">åˆ†æ</h3>
<p>å¾ˆæ˜æ˜¾çš„ä¸€é“ç½‘ç»œæµé¢˜ï¼Œå¯ä»¥ç›´æ¥ä¸Šç½‘ç»œæµçš„æ¿å­ï¼Œä½†æ˜¯è’Ÿè’»çš„æˆ‘ï¼Œç«Ÿç„¶æŠŠç½‘ç»œæµçš„æ¿å­ç»™å¿˜äº†ï¼Œè¿å¸¦é‚£äº›ç®—æ³•ä¹Ÿæƒ³ä¸èµ·æ¥äº† ğŸ˜¦ çœŸèœã€‚åªå¥½æš´åŠ›æ¨æµã€‚ä»èµ·å§‹èŠ‚ç‚¹å¼€å§‹ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹çš„å‡ºè¾¹ä½¿ç”¨ dfs å‘å…¶åç»­èŠ‚ç‚¹æ¨æµï¼Œç›´åˆ°æ¨åˆ°ç»ˆæ­¢èŠ‚ç‚¹ï¼Œå¯¹äºå½“å‰èŠ‚ç‚¹æ¨ä¸è¿‡å»çš„æµé‡è¦è¿”è¿˜ç»™çˆ¶èŠ‚ç‚¹ã€‚ç”±äºå¯èƒ½æœ‰ç¯ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œæ ‡è®°ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹åœ¨å½“å‰ä¸€æ¬¡æ¨æµè¿‡ç¨‹ä¸­è¢«è®¿é—®è¿‡ï¼Œå°±æ ‡è®°ä»¥ä¸‹ï¼Œå¦‚æœæ¨æµç»“æŸï¼ˆå³é€†å‘è¿”è¿˜å‰©ä½™æµæ—¶ï¼‰å°±å–æ¶ˆæ ‡è®°ã€‚æœ€ç»ˆæš´åŠ› ACï¼ˆè¿™éƒ½æ²¡æœ‰ TLEï¼ŒPAT ä¸Šçš„æµ‹è¯•æ•°æ®çœŸçš„å¤ªå¼±äº†ï¼ï¼‰ã€‚</p>
<h3 id="ä»£ç ">ä»£ç </h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">505</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-built_in">unordered_map</span> &lt; <span class="hljs-built_in">string</span>, <span class="hljs-keyword">int</span> &gt; ump;<br><br><span class="hljs-comment">// å‰å‘æ˜Ÿå­˜è¾¹</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br>    <span class="hljs-keyword">int</span> to, next, capability;<br>&#125;edge;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> len_e;<br><span class="hljs-keyword">int</span> c[MAXN];<br><span class="hljs-keyword">int</span> h[MAXN];<br><span class="hljs-keyword">int</span> f[MAXN];<br>edge e[MAXN];<br><br><span class="hljs-comment">// åˆå§‹åŒ–èŠ‚ç‚¹</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = n<span class="hljs-number">-1</span>; ~i; --i) &#123;<br>        h[i] = <span class="hljs-number">-1</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ–°å¢è¾¹</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> v)</span> </span>&#123;<br>    e[len_e].next = h[x];<br>    e[len_e].to = y;<br>    e[len_e].capability = v;<br>    h[x] = len_e++;<br>&#125;<br><br><span class="hljs-comment">// æ¨æµ</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> v)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span>(x == <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = h[x]; i != <span class="hljs-number">-1</span> &amp;&amp; v; i = e[i].next) &#123;<br>        <span class="hljs-keyword">if</span>(f[e[i].to] || e[i].capability == <span class="hljs-number">0</span>)    <span class="hljs-keyword">continue</span>;<br>        f[e[i].to] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">int</span> s, t;<br>        <span class="hljs-keyword">if</span>(e[i].capability &gt;= v) &#123;<br>            s = update(e[i].to, v);<br>            t = v-s;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            s = update(e[i].to, e[i].capability);<br>            t = e[i].capability-s;<br>        &#125;<br>        v -= t;<br>        c[e[i].to] += t;<br>        e[i].capability -= t;<br>        f[e[i].to] = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> v;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">answer</span><span class="hljs-params">()</span> </span>&#123;<br>    c[<span class="hljs-number">0</span>] = INF;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = h[<span class="hljs-number">0</span>]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>        <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(f));<br>        f[e[i].to] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">int</span> s = update(e[i].to, e[i].capability);<br>        <span class="hljs-keyword">int</span> t = e[i].capability - s;<br>        c[e[i].to] += t;<br>        e[i].capability -= t; <br>        f[e[i].to] = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> c[<span class="hljs-number">1</span>];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">char</span> s[<span class="hljs-number">4</span>], t[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">int</span> m;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s%d&quot;</span>, s, t, &amp;m);<br>    ump[s] = n++;<br>    ump[t] = n++;<br>    init(MAXN);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = m; i; --i) &#123;<br>        <span class="hljs-keyword">char</span> ts[<span class="hljs-number">4</span>], tv[<span class="hljs-number">4</span>];<br>        <span class="hljs-keyword">int</span> tst, tvt, cap;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s%d&quot;</span>, ts, tv, &amp;cap);<br>        <span class="hljs-keyword">if</span>(ump.count(ts) == <span class="hljs-number">0</span>) &#123;<br>            ump[ts] = n++;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(ump.count(tv) == <span class="hljs-number">0</span>) &#123;<br>            ump[tv] = n++;<br>        &#125;<br>        tst = ump[ts];<br>        tvt = ump[tv];<br>        add(tst, tvt, cap);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, answer());<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="é™„å½•">é™„å½•</h3>
<ul>
<li>
<h4 id="Dinic-ç®—æ³•">Dinic ç®—æ³•</h4>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<br><br><span class="hljs-comment">// Dinic ç®—æ³•</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Dinic</span> &#123;</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> _DINIC_</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ll long long </span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXN 1505</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXM 1505</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 1e12</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br>    <br>    ll cnt_edge;    <span class="hljs-comment">// è¾¹æ•°</span><br>    ll head[MAXN];  <span class="hljs-comment">// èŠ‚ç‚¹çš„ç¬¬ä¸€æ¡è¾¹çš„ç¼–å·</span><br>    ll shead[MAXN]; <span class="hljs-comment">// shead ç”¨æ¥ä¸´æ—¶ä¿å­˜ head çš„å‰¯æœ¬</span><br>    ll level[MAXN]; <span class="hljs-comment">// èŠ‚ç‚¹æ‰€åœ¨å±‚æ¬¡</span><br>    <span class="hljs-comment">// é“¾å¼å‰å‘æ˜Ÿ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span> &#123;</span><br>        ll to, next, flow; <span class="hljs-comment">// åˆ†åˆ«ä»£è¡¨ï¼šè¾¹çš„ç»ˆç‚¹ã€åŒèµ·ç‚¹çš„ä¸‹ä¸€æ¡è¾¹çš„ç¼–å·ã€è¾¹çš„æµé‡</span><br>        edge() &#123;&#125;<br>        edge(ll _to, ll _next, ll _flow): to(_to), next(_next), flow(_flow) &#123;&#125;<br>    &#125;e[MAXM];       <span class="hljs-comment">// è¾¹æ•°ç»„ </span><br>    Dinic() &#123;&#125;<br>    <span class="hljs-comment">// åˆå§‹åŒ–å‰å‘æ˜Ÿç»“æ„</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(ll n)</span> </span>&#123;<br>        cnt_edge = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">memset</span>(head, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(ll)*(n+<span class="hljs-number">1</span>));<br>    &#125;<br>    <span class="hljs-comment">// æ·»åŠ è¾¹ï¼ˆæ­£åå‘ä¸¤æ¡è¾¹ï¼‰</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addEdge</span><span class="hljs-params">(ll u, ll v, ll w)</span> </span>&#123;<br>        e[cnt_edge].to = v;<br>        e[cnt_edge].next = head[u];<br>        e[cnt_edge].flow = w;<br>        head[u] = cnt_edge++;<br>        e[cnt_edge].to = u;<br>        e[cnt_edge].next = head[v];<br>        e[cnt_edge].flow = <span class="hljs-number">0</span>;<br>        head[v] = cnt_edge++;<br>    &#125;<br>    <span class="hljs-comment">// BFS å¯»æ‰¾å¢å¹¿è·¯ï¼Œæ„å»ºå±‚æ¬¡ç½‘ç»œ</span><br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">(ll s, ll t, ll n)</span> </span>&#123;<br>        <span class="hljs-built_in">memset</span>(level, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(ll)*(n+<span class="hljs-number">1</span>));<br>        <span class="hljs-built_in">queue</span> &lt;ll&gt; bfsq;<br>        bfsq.push(s);<br>        level[s] = <span class="hljs-number">1</span>;   <span class="hljs-comment">// 0 ç”¨æ¥è¡¨ç¤ºæ²¡æœ‰ bfs åˆ°ï¼Œæ•…æºç‚¹æ·±åº¦ä» 1 å¼€å§‹</span><br>        <span class="hljs-keyword">while</span>(!bfsq.empty()) &#123;<br>            ll u = bfsq.front();<br>            bfsq.pop();<br>            <span class="hljs-keyword">for</span>(ll i = head[u]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>                ll v = e[i].to, w = e[i].flow;<br>                <span class="hljs-keyword">if</span>(!level[v] &amp;&amp; w) &#123;<br>                    level[v] = level[u] + <span class="hljs-number">1</span>;<br>                    bfsq.push(v);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(level[t])    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-comment">// DFS è¿›è¡Œè·¯å¾„å¢å¹¿</span><br>    <span class="hljs-function">ll <span class="hljs-title">dfs</span><span class="hljs-params">(ll u, ll curflow, ll t)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(u == t) &#123;<br>            <span class="hljs-keyword">return</span> curflow;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(ll &amp; i = shead[u]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>            ll v = e[i].to, w = e[i].flow;<br>            <span class="hljs-keyword">if</span>(level[v] == level[u] + <span class="hljs-number">1</span> &amp;&amp; w) &#123;<br>                ll maxflow = dfs(v, min(curflow, w), t);<br>                <span class="hljs-keyword">if</span>(maxflow) &#123;<br>                    e[i].flow -= maxflow;<br>                    e[i^<span class="hljs-number">1</span>].flow += maxflow;<br>                    <span class="hljs-keyword">return</span> maxflow;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-comment">// æ±‚æœ€å¤§æµ</span><br>    <span class="hljs-function">ll <span class="hljs-title">maxFlow</span><span class="hljs-params">(ll s, ll t, ll n)</span> </span>&#123;<br>        ll ans = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span>(bfs(s,t,n)) &#123;<br>            ll maxflow = INF, curflow;<br>            <span class="hljs-built_in">memcpy</span>(shead, head, <span class="hljs-keyword">sizeof</span>(head));<br>            <span class="hljs-keyword">while</span>((curflow = dfs(s, maxflow, t))) &#123;<br>                ans += curflow;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ans;<br>    &#125;<br>&#125;;<br><br><span class="hljs-built_in">unordered_map</span> &lt; <span class="hljs-built_in">string</span>, <span class="hljs-keyword">int</span> &gt; ump;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    Dinic dinic;<br>    <span class="hljs-keyword">char</span> s[<span class="hljs-number">4</span>], t[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">int</span> n = <span class="hljs-number">1</span>, m = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s%d&quot;</span>, s, t, &amp;m);<br>    ump[s] = n++;<br>    ump[t] = n++;<br>    <br>    dinic.init(MAXN<span class="hljs-number">-1</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = m; i; --i) &#123;<br>        <span class="hljs-keyword">char</span> ts[<span class="hljs-number">4</span>], tv[<span class="hljs-number">4</span>];<br>        <span class="hljs-keyword">int</span> tst, tvt, cap;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s%d&quot;</span>, ts, tv, &amp;cap);<br>        <span class="hljs-keyword">if</span>(ump.count(ts) == <span class="hljs-number">0</span>) &#123;<br>            ump[ts] = n++;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(ump.count(tv) == <span class="hljs-number">0</span>) &#123;<br>            ump[tv] = n++;<br>        &#125;<br>        tst = ump[ts];<br>        tvt = ump[tv];<br>        dinic.addEdge(tst, tvt, cap);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, dinic.maxFlow(ump[s],ump[t],n));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li>
<h4 id="ISAP-ç®—æ³•">ISAP ç®—æ³•</h4>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<br><br><span class="hljs-comment">// ISAP ç®—æ³•</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ISAP</span> &#123;</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> _ISAP_</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ll long long </span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXN 1205</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXM 1205</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 1e12</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br>    <br>    ll cnt_edge;    <span class="hljs-comment">// è¾¹æ•°</span><br>    ll head[MAXN];  <span class="hljs-comment">// èŠ‚ç‚¹çš„ç¬¬ä¸€æ¡è¾¹çš„ç¼–å·</span><br>    ll shead[MAXN]; <span class="hljs-comment">// shead ç”¨æ¥ä¸´æ—¶ä¿å­˜ head çš„å‰¯æœ¬</span><br>    ll level[MAXN]; <span class="hljs-comment">// èŠ‚ç‚¹æ‰€åœ¨å±‚æ¬¡</span><br>    ll gap[MAXN+<span class="hljs-number">1</span>];   <span class="hljs-comment">// å±‚æ¬¡èŠ‚ç‚¹æ•°</span><br>    <span class="hljs-comment">// é“¾å¼å‰å‘æ˜Ÿ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span> &#123;</span><br>        ll to, next, flow; <span class="hljs-comment">// åˆ†åˆ«ä»£è¡¨ï¼šè¾¹çš„ç»ˆç‚¹ã€åŒèµ·ç‚¹çš„ä¸‹ä¸€æ¡è¾¹çš„ç¼–å·ã€è¾¹çš„æµé‡</span><br>        edge() &#123;&#125;<br>        edge(ll _to, ll _next, ll _flow): to(_to), next(_next), flow(_flow) &#123;&#125;<br>    &#125;e[MAXM];       <span class="hljs-comment">// è¾¹æ•°ç»„ </span><br>    ISAP() &#123;&#125;<br>    <span class="hljs-comment">// åˆå§‹åŒ–å‰å‘æ˜Ÿç»“æ„</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(ll n)</span> </span>&#123;<br>        cnt_edge = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">memset</span>(head, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(ll)*(n+<span class="hljs-number">1</span>));<br>    &#125;<br>    <span class="hljs-comment">// æ·»åŠ è¾¹ï¼ˆæ­£åå‘ä¸¤æ¡è¾¹ï¼‰</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addEdge</span><span class="hljs-params">(ll u, ll v, ll w)</span> </span>&#123;<br>        e[cnt_edge].to = v;<br>        e[cnt_edge].next = head[u];<br>        e[cnt_edge].flow = w;<br>        head[u] = cnt_edge++;<br>        e[cnt_edge].to = u;<br>        e[cnt_edge].next = head[v];<br>        e[cnt_edge].flow = <span class="hljs-number">0</span>;<br>        head[v] = cnt_edge++;<br>    &#125;<br>    <span class="hljs-comment">// BFS å¯»æ‰¾å¢å¹¿è·¯ï¼Œæ„å»ºå±‚æ¬¡ç½‘ç»œ</span><br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">(ll s, ll t, ll n)</span> </span>&#123;<br>        <span class="hljs-built_in">memset</span>(level, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(ll)*(n+<span class="hljs-number">1</span>));<br>        <span class="hljs-built_in">memset</span>(gap, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(ll)*(n+<span class="hljs-number">2</span>));   <span class="hljs-comment">// æœ€å¤§ level å¯è¾¾ n+1ï¼ˆè§ä¸‹æ–‡ï¼‰</span><br>        <span class="hljs-built_in">queue</span> &lt;ll&gt; bfsq;<br>        level[t] = <span class="hljs-number">1</span>;   <span class="hljs-comment">// 0 ç”¨æ¥è¡¨ç¤ºæ²¡æœ‰ bfs åˆ°ï¼Œæ•…åˆ°æ±‡ç‚¹çš„è·ç¦»ä» 1 å¼€å§‹</span><br>        gap[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;    <br>        bfsq.push(t); <br>        <span class="hljs-keyword">while</span>(!bfsq.empty()) &#123;<br>            ll u = bfsq.front();<br>            bfsq.pop();<br>            <span class="hljs-keyword">for</span>(ll i = head[u]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>                <span class="hljs-comment">// åœ¨åå›¾ä¸­æ„å»ºå±‚æ¬¡ç½‘ç»œï¼Œæ•…éœ€åå‘åˆ¤æ–­è·¯å¾„å®¹é‡</span><br>                ll v = e[i].to;<br>                <span class="hljs-keyword">if</span>(!level[v] &amp;&amp; e[i^<span class="hljs-number">1</span>].flow) &#123;<br>                    level[v] = level[u] + <span class="hljs-number">1</span>;<br>                    ++gap[level[v]];<br>                    bfsq.push(v);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// åˆ¤æ–­ s åˆ° t æ˜¯å¦æœ‰å¢å¹¿è·¯</span><br>        <span class="hljs-keyword">if</span>(level[s])    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-comment">// é‡è´´æ ‡ç­¾ï¼ˆæ›´æ–°å±‚æ¬¡æ·±åº¦ï¼‰</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">relabel</span><span class="hljs-params">(ll u, ll n)</span> </span>&#123;<br>        level[u] = n + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span>(ll i = head[u]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>            ll v = e[i].to, w = e[i].flow;<br>            <span class="hljs-keyword">if</span>(level[v] &lt; level[u] - <span class="hljs-number">1</span> &amp;&amp; w) &#123;<br>                level[u] = level[v] + <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// DFS è¿›è¡Œè·¯å¾„å¢å¹¿</span><br>    <span class="hljs-function">ll <span class="hljs-title">dfs</span><span class="hljs-params">(ll u, ll curflow, ll s, ll t, ll n)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(u == t) &#123;<br>            <span class="hljs-keyword">return</span> curflow;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(ll &amp; i = shead[u]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>            ll v = e[i].to, w = e[i].flow;<br>            <span class="hljs-keyword">if</span>(level[v] == level[u] - <span class="hljs-number">1</span> &amp;&amp; w) &#123;<br>                ll maxflow = dfs(v, min(curflow, w), s, t, n);<br>                <span class="hljs-keyword">if</span>(maxflow) &#123;<br>                    e[i].flow -= maxflow;<br>                    e[i^<span class="hljs-number">1</span>].flow += maxflow;<br>                    <span class="hljs-keyword">return</span> maxflow;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// ç¨‹åºæ‰§è¡Œåˆ°æ­¤è¯´æ˜è¯¥ç‚¹å‡ºå»çš„æ‰€æœ‰ç‚¹éƒ½å·²ç»æµè¿‡äº†</span><br>        <span class="hljs-comment">// æ­¤æ—¶éœ€è¦æ›´æ”¹å±‚æ¬¡æ·±åº¦</span><br>        <span class="hljs-comment">// åŒæ ·è¦æ›´æ–°å¯¹åº”ç‚¹çš„ shead</span><br>        shead[u] = head[u];<br>        --gap[level[u]];<br>        <span class="hljs-keyword">if</span>(gap[level[u]] == <span class="hljs-number">0</span>) &#123;<br>            level[s] = n + <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-comment">// æé«˜å½“å‰å±‚æ¬¡æ·±åº¦ï¼ˆå› ä¸ºå¯èƒ½å­˜åœ¨è·¯å¾„æ›´é•¿çš„å¢å¹¿ï¼‰</span><br>        <span class="hljs-comment">// æ–¹æ¡ˆä¸€ï¼šç›´æ¥æ›´æ–°ä¸ºå‡ºè¾¹çš„æœ€å°å±‚æ¬¡æ·±åº¦+1</span><br>        relabel(u, n);<br>        <span class="hljs-comment">// æ–¹æ¡ˆäºŒï¼šç›´æ¥æ›´æ–°ä¸ºåŸå±‚æ¬¡æ·±åº¦+1</span><br>        <span class="hljs-comment">// ++level[u];</span><br>        ++gap[level[u]];<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-comment">// æ±‚æœ€å¤§æµ</span><br>    <span class="hljs-function">ll <span class="hljs-title">maxFlow</span><span class="hljs-params">(ll s, ll t, ll n)</span> </span>&#123;<br>        ll ans = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">if</span>(bfs(s,t,n)) &#123;<br>            ll maxflow = INF;<br>            <span class="hljs-built_in">memcpy</span>(shead, head, <span class="hljs-keyword">sizeof</span>(head));<br>            <span class="hljs-keyword">while</span>(level[s] &lt;= n) &#123;<br>                ans += dfs(s, maxflow, s, t, n);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ans;<br>    &#125;<br>&#125;;<br><br><span class="hljs-built_in">unordered_map</span> &lt; <span class="hljs-built_in">string</span>, <span class="hljs-keyword">int</span> &gt; ump;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    ISAP isap;<br>    <span class="hljs-keyword">char</span> s[<span class="hljs-number">4</span>], t[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">int</span> n = <span class="hljs-number">1</span>, m = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s%d&quot;</span>, s, t, &amp;m);<br>    ump[s] = n++;<br>    ump[t] = n++;<br>    <br>    isap.init(MAXN<span class="hljs-number">-1</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = m; i; --i) &#123;<br>        <span class="hljs-keyword">char</span> ts[<span class="hljs-number">4</span>], tv[<span class="hljs-number">4</span>];<br>        <span class="hljs-keyword">int</span> tst, tvt, cap;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s%d&quot;</span>, ts, tv, &amp;cap);<br>        <span class="hljs-keyword">if</span>(ump.count(ts) == <span class="hljs-number">0</span>) &#123;<br>            ump[ts] = n++;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(ump.count(tv) == <span class="hljs-number">0</span>) &#123;<br>            ump[tv] = n++;<br>        &#125;<br>        tst = ump[ts];<br>        tvt = ump[tv];<br>        isap.addEdge(tst, tvt, cap);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, isap.maxFlow(ump[s],ump[t],n));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li>
<h4 id="HLPP-ç®—æ³•">HLPP ç®—æ³•</h4>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<br><br><span class="hljs-comment">// HLPP ç®—æ³•</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">HLPP</span> &#123;</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> _HLPP_</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ll long long </span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXN 1205</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXM 1205</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 1e12</span><br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br>    <br>    ll cnt_edge;    <span class="hljs-comment">// è¾¹æ•°</span><br>    ll head[MAXN];  <span class="hljs-comment">// èŠ‚ç‚¹çš„ç¬¬ä¸€æ¡è¾¹çš„ç¼–å·</span><br>    ll rflow[MAXN]; <span class="hljs-comment">// æ¯ä¸ªç‚¹å¯¹åº”çš„ä½™æµï¼ˆæ‰€æœ‰èŠ‚ç‚¹çš„ä½™æµåˆå§‹åŒ–ä¸º0ï¼‰</span><br>    ll level[MAXN]; <span class="hljs-comment">// èŠ‚ç‚¹æ‰€åœ¨å±‚æ¬¡</span><br>    ll flag[MAXN];  <span class="hljs-comment">// æ ‡è®°æ˜¯å¦å·²ç»åœ¨å±‚æ¬¡æ·±åº¦é“¾è¡¨æ•°ç»„ä¸­</span><br>    ll gap[MAXN&lt;&lt;<span class="hljs-number">1</span>];        <span class="hljs-comment">// å±‚æ¬¡èŠ‚ç‚¹æ•°ï¼Œé‡è´´æ ‡ç­¾åå±‚æ¬¡æ·±åº¦å¯èƒ½è¾¾åˆ° 2n</span><br>    <span class="hljs-comment">// å±‚æ¬¡æ·±åº¦ç»“æ„ä½“</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">depth</span> &#123;</span><br>        ll node;    <span class="hljs-comment">// èŠ‚ç‚¹ç¼–å·</span><br>        ll level;   <span class="hljs-comment">// èŠ‚ç‚¹å±‚æ¬¡æ·±åº¦</span><br>        depth() &#123;&#125;<br>        depth(ll _node, ll _level): node(_node), level(_level) &#123;&#125;<br>        <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> &lt; (<span class="hljs-keyword">const</span> depth d) <span class="hljs-keyword">const</span> &#123;<br>            <span class="hljs-keyword">return</span> level &lt; d.level;<br>        &#125;<br>    &#125;;<br>    <span class="hljs-comment">// å±‚æ¬¡æ·±åº¦ä¼˜å…ˆé˜Ÿåˆ—</span><br>    <span class="hljs-built_in">priority_queue</span> &lt;depth&gt; pq;<br>    <span class="hljs-comment">// é“¾å¼å‰å‘æ˜Ÿ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span> &#123;</span><br>        ll to, next, flow; <span class="hljs-comment">// åˆ†åˆ«ä»£è¡¨ï¼šè¾¹çš„ç»ˆç‚¹ã€åŒèµ·ç‚¹çš„ä¸‹ä¸€æ¡è¾¹çš„ç¼–å·ã€è¾¹çš„æµé‡</span><br>        edge() &#123;&#125;<br>        edge(ll _to, ll _next, ll _flow): to(_to), next(_next), flow(_flow) &#123;&#125;<br>    &#125;e[MAXM];       <span class="hljs-comment">// è¾¹æ•°ç»„ </span><br>    HLPP() &#123;&#125;<br>    <span class="hljs-comment">// åˆå§‹åŒ–å‰å‘æ˜Ÿç»“æ„</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(ll n)</span> </span>&#123;<br>        cnt_edge = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">memset</span>(head, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(ll)*(n+<span class="hljs-number">1</span>));<br>    &#125;<br>    <span class="hljs-comment">// æ·»åŠ è¾¹ï¼ˆæ­£åå‘ä¸¤æ¡è¾¹ï¼‰</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addEdge</span><span class="hljs-params">(ll u, ll v, ll w)</span> </span>&#123;<br>        e[cnt_edge].to = v;<br>        e[cnt_edge].next = head[u];<br>        e[cnt_edge].flow = w;<br>        head[u] = cnt_edge++;<br>        e[cnt_edge].to = u;<br>        e[cnt_edge].next = head[v];<br>        e[cnt_edge].flow = <span class="hljs-number">0</span>;<br>        head[v] = cnt_edge++;<br>    &#125;<br>    <span class="hljs-comment">// BFS å¯»æ‰¾å¢å¹¿è·¯ï¼Œæ„å»ºå±‚æ¬¡ç½‘ç»œï¼ˆåå‘æ„å»ºï¼‰</span><br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">(ll s, ll t, ll n)</span> </span>&#123;<br>        <span class="hljs-built_in">memset</span>(level, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(ll)*(n+<span class="hljs-number">1</span>));<br>        <span class="hljs-built_in">queue</span> &lt;ll&gt; bfsq;<br>        level[t] = <span class="hljs-number">1</span>;   <span class="hljs-comment">// 0 ç”¨æ¥è¡¨ç¤ºæ²¡æœ‰ bfs åˆ°ï¼Œæ•…åˆ°æ±‡ç‚¹çš„è·ç¦»ä» 1 å¼€å§‹</span><br>        bfsq.push(t); <br>        <span class="hljs-keyword">while</span>(!bfsq.empty()) &#123;<br>            ll u = bfsq.front();<br>            bfsq.pop();<br>            <span class="hljs-keyword">for</span>(ll i = head[u]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>                <span class="hljs-comment">// åœ¨åå›¾ä¸­æ„å»ºå±‚æ¬¡ç½‘ç»œï¼Œæ•…éœ€åå‘åˆ¤æ–­è·¯å¾„å®¹é‡</span><br>                ll v = e[i].to;<br>                <span class="hljs-keyword">if</span>(!level[v] &amp;&amp; e[i^<span class="hljs-number">1</span>].flow) &#123;<br>                    level[v] = level[u] + <span class="hljs-number">1</span>;<br>                    bfsq.push(v);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// åˆ¤æ–­ s åˆ° t æ˜¯å¦æœ‰å¢å¹¿è·¯</span><br>        <span class="hljs-keyword">if</span>(level[s])    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-comment">// é¢„æµæ¨è¿›</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">preflowPush</span><span class="hljs-params">(ll u, ll s, ll t)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span>(ll i = head[u]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>            ll v = e[i].to, w = e[i].flow;<br>            <span class="hljs-keyword">if</span>(level[v] == level[u] - <span class="hljs-number">1</span> &amp;&amp; w) &#123;<br>                ll maxflow = min(rflow[u], e[i].flow);<br>                e[i].flow -= maxflow;<br>                e[i^<span class="hljs-number">1</span>].flow += maxflow;<br>                rflow[u] -= maxflow;<br>                rflow[v] += maxflow;<br>                <span class="hljs-keyword">if</span>(v != s &amp;&amp; v != t &amp;&amp; !flag[v]) &#123;<br>                    pq.push(depth&#123;v, level[v]&#125;);<br>                    flag[v] = <span class="hljs-number">1</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span>(rflow[u] == <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-comment">// å…¨éƒ¨æµé‡æ¨é€å®Œæ¯•</span><br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// é‡è´´æ ‡ç­¾ï¼ˆæ›´æ–°å±‚æ¬¡æ·±åº¦ï¼‰</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">relabel</span><span class="hljs-params">(ll u, ll n)</span> </span>&#123;<br>        level[u] = <span class="hljs-number">2</span>*n;<br>        <span class="hljs-keyword">for</span>(ll i = head[u]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>            ll v = e[i].to, w = e[i].flow;<br>            <span class="hljs-keyword">if</span>(level[v] &lt; level[u] - <span class="hljs-number">1</span> &amp;&amp; w) &#123;<br>                level[u] = level[v] + <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// æ±‚æœ€å¤§æµ</span><br>    <span class="hljs-function">ll <span class="hljs-title">maxFlow</span><span class="hljs-params">(ll s, ll t, ll n)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(!bfs(s,t,n)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-comment">// é˜²æ­¢sçš„ä¸´è¿‘èŠ‚ç‚¹è¿‡æ—©çš„æ¨æµå›sèŠ‚ç‚¹</span><br>        level[s] = n + <span class="hljs-number">1</span>;<br>        <span class="hljs-comment">// åˆå§‹åŒ– gap æ•°ç»„</span><br>        <span class="hljs-built_in">memset</span>(gap, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(ll)*((n+<span class="hljs-number">1</span>)&lt;&lt;<span class="hljs-number">1</span>));<br>        <span class="hljs-keyword">for</span>(ll i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;<br>            <span class="hljs-keyword">if</span>(level[i]) &#123;<br>                ++gap[level[i]];<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// è®¾å®šæºç‚¹ s çš„å‡ºè¾¹èŠ‚ç‚¹åˆå§‹ä½™æµ</span><br>        <span class="hljs-keyword">for</span>(ll i = head[s]; i != <span class="hljs-number">-1</span>; i = e[i].next) &#123;<br>            ll v = e[i].to, w = e[i].flow;<br>            <span class="hljs-keyword">if</span>(w) &#123;<br>                e[i].flow -= w;<br>                e[i^<span class="hljs-number">1</span>].flow += w;<br>                rflow[s] -= w;<br>                rflow[v] += w;<br>                <span class="hljs-keyword">if</span>(v != s &amp;&amp; v != t &amp;&amp; !flag[v]) &#123;<br>                    pq.push(depth&#123;v, level[v]&#125;);<br>                    flag[v] = <span class="hljs-number">1</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// å¼€å§‹ä»æœ€é«˜é«˜åº¦èŠ‚ç‚¹é¢„æ¨æµ</span><br>        <span class="hljs-keyword">while</span>(!pq.empty()) &#123;<br>            ll u = pq.top().node;<br>            pq.pop();<br>            flag[u] = <span class="hljs-number">0</span>;<br>            preflowPush(u, s, t);<br>            <span class="hljs-keyword">if</span>(rflow[u]) &#123;<br>                <span class="hljs-comment">// å¦‚æœå½“å‰èŠ‚ç‚¹è¿˜æœ‰ä½™æµ</span><br>                --gap[level[u]];<br>                <span class="hljs-keyword">if</span>(!gap[level[u]]) &#123;<br>                    <span class="hljs-comment">// æ–­å±‚</span><br>                    <span class="hljs-keyword">for</span>(ll v = <span class="hljs-number">1</span>; v &lt;= n; ++v) &#123;<br>                        <span class="hljs-keyword">if</span>(v != s &amp;&amp; v != t &amp;&amp; level[v] &gt; level[u] &amp;&amp; level[v] &lt; n + <span class="hljs-number">1</span>) &#123;<br>                            level[v] = n + <span class="hljs-number">1</span>;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>                relabel(u, n); <span class="hljs-comment">// é‡è´´æ ‡ç­¾ï¼Œæå‡é«˜åº¦</span><br>                ++gap[level[u]];<br>                pq.push(depth&#123;u, level[u]&#125;);<br>                flag[u] = <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> rflow[t];<br>    &#125;<br>&#125;;<br><br><span class="hljs-built_in">unordered_map</span> &lt; <span class="hljs-built_in">string</span>, <span class="hljs-keyword">int</span> &gt; ump;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    HLPP hlpp;<br>    <span class="hljs-keyword">char</span> s[<span class="hljs-number">4</span>], t[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">int</span> n = <span class="hljs-number">1</span>, m = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s%d&quot;</span>, s, t, &amp;m);<br>    ump[s] = n++;<br>    ump[t] = n++;<br>    <br>    hlpp.init(MAXN<span class="hljs-number">-1</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = m; i; --i) &#123;<br>        <span class="hljs-keyword">char</span> ts[<span class="hljs-number">4</span>], tv[<span class="hljs-number">4</span>];<br>        <span class="hljs-keyword">int</span> tst, tvt, cap;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s%d&quot;</span>, ts, tv, &amp;cap);<br>        <span class="hljs-keyword">if</span>(ump.count(ts) == <span class="hljs-number">0</span>) &#123;<br>            ump[ts] = n++;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(ump.count(tv) == <span class="hljs-number">0</span>) &#123;<br>            ump[tv] = n++;<br>        &#125;<br>        tst = ump[ts];<br>        tvt = ump[tv];<br>        hlpp.addEdge(tst, tvt, cap);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, hlpp.maxFlow(ump[s],ump[t],n));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/ACM/">ACM</a>
                    
                      <a class="hover-with-bg" href="/categories/ACM/%E9%A2%98%E8%A7%A3/">é¢˜è§£</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/ACM/">ACM</a>
                    
                      <a class="hover-with-bg" href="/tags/%E9%A2%98%E8%A7%A3/">é¢˜è§£</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/08/14/ACM/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/%E7%BD%91%E7%BB%9C%E6%B5%81/%E6%9C%80%E5%A4%A7%E6%B5%81/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">æœ€å¤§æµ</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/08/14/ACM/%E9%A2%98%E8%A7%A3/PAT%E3%80%8C1002%20Business%20(35%E5%88%86)%E3%80%8D/">
                        <span class="hidden-mobile">PATã€Œ1002 Business (35åˆ†)ã€</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.lazyComments('waline', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js', function () {
        new Waline({
          el: "#waline",
          placeholder: "éƒ½çœ‹åˆ°è¿™é‡Œäº†ï¼Œç•™ä¸ªè„šå°å†èµ°å‘—~",
          path: window.location.pathname,
          avatar: "retro",
          visitor: true,
          meta: ["nick","mail","link"],
          pageSize: "10",
          lang: "zh-CN",
          highlight: true,
          serverURL: "https://waline-one-beta.vercel.app/",
          avatarCDN: "https://gravatar.loli.net/avatar/",
          avatarForce: false,
          requiredMeta: [],
          emoji: ["https://cdn.jsdelivr.net/gh/hotarugali/Emoji@bilibili_tv_gif/waline/bilibili_tv_gif","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@bilibiliHotKey/waline/bilibiliHotKey","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@bilibili2233/waline/bilibili2233","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@smallshake/waline/smallshake","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@alu/waline/alu","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@QQ/waline/QQ","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@Tieba-New/waline/Tieba-New","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@weibo/waline/weibo"],
          // emojiMaps: ,
          login: "enable",
          dark: 'html[data-user-color-scheme="dark"]',
        });
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the
    <a target="_blank" href="https://waline.js.org" rel="nofollow noopener noopener">comments powered by Waline.</a>
  </noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
      <div class="col-lg-7 mx-auto nopadding-x-md">
        <div class="container custom mx-auto">
          <script src="https://myhkw.cn/api/player/161389264877" id="myhk" key="161389264877" m="1"></script>
        </div>
      </div>
    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>




  <script defer src="/js/leancloud.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>





  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" />
  





  <script  src="https://cdn.jsdelivr.net/npm/mermaid@8.8.3/dist/mermaid.min.js" ></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({"theme":"default"});
    }
  </script>




  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?c194cf0c8cbc33bfb846ba1329537d81";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  
    <!-- Google Analytics -->
    <script defer>
      window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) };
      ga.l = +new Date;
      ga('create', 'G-SXJN0942X9', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  
    <!-- Google gtag.js -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D3DEHLLP3W"></script>
    <script defer>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-D3DEHLLP3W');
    </script>
  

  

  

  





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
